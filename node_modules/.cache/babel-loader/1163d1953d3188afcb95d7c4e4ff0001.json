{"ast":null,"code":"import axios from 'axios';\nimport { User } from '../models/User';\nimport { FailedLoginError } from '../errors/FailedLoginError';\nconst libraryClient = axios.create({\n  baseURL: 'http://100.25.132.252:3000',\n  withCredentials: true\n}); //@adam : Library-express is running on my EC2 with public IP 18.232.125.207\n\nexport async function getAllUsers() {\n  const response = await libraryClient.get('/users'); // return response.data;\n\n  console.log(response.data);\n  return response.data.map(userObj => {\n    const {\n      id,\n      username,\n      password,\n      firstname,\n      lastname,\n      email,\n      role\n    } = userObj;\n    return new User(id, username, password, firstname, lastname, email, role);\n  });\n}\nexport async function getSingle() {\n  const response = await libraryClient.get('/users/2');\n  console.log(response.data); //return response.data;\n\n  return response.request.map(user => {\n    return new User(user.userid, user.username, user.password, user.firstname, user.lastname, user.email, user.role);\n  })[0];\n}\nexport async function login(un, pw) {\n  try {\n    const response = await libraryClient.post('/login', {\n      username: un,\n      password: pw\n    });\n    const {\n      id,\n      username,\n      password,\n      firstname,\n      lastname,\n      email,\n      role\n    } = response.data;\n    return new User(id, username, password, firstname, lastname, email, role);\n  } catch (e) {\n    if (e.response.status === 401 || e.response.status === 400) {\n      throw new FailedLoginError('Failed to authenticate', un);\n    } else {\n      // We could throw a different custom error, this exposes a little too much to the user.\n      throw e;\n    }\n  }\n}","map":{"version":3,"sources":["/Users/Shadow/react1/myapp/src/api/LibraryClient.tsx"],"names":["axios","User","FailedLoginError","libraryClient","create","baseURL","withCredentials","getAllUsers","response","get","console","log","data","map","userObj","id","username","password","firstname","lastname","email","role","getSingle","request","user","userid","login","un","pw","post","e","status"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,gBAArB;AACA,SAASC,gBAAT,QAAiC,4BAAjC;AAGA,MAAMC,aAAa,GAAGH,KAAK,CAACI,MAAN,CAAa;AACjCC,EAAAA,OAAO,EAAE,4BADwB;AAEjCC,EAAAA,eAAe,EAAE;AAFgB,CAAb,CAAtB,C,CAKA;;AAGA,OAAO,eAAeC,WAAf,GAAqD;AAC1D,QAAMC,QAAQ,GAAG,MAAML,aAAa,CAACM,GAAd,CAAkB,QAAlB,CAAvB,CAD0D,CAE1D;;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,QAAQ,CAACI,IAArB;AACA,SAAOJ,QAAQ,CAACI,IAAT,CAAcC,GAAd,CAAmBC,OAAD,IAAkB;AACzC,UAAM;AAACC,MAAAA,EAAD;AAAKC,MAAAA,QAAL;AAAeC,MAAAA,QAAf;AAAyBC,MAAAA,SAAzB;AAAoCC,MAAAA,QAApC;AAA8CC,MAAAA,KAA9C;AAAqDC,MAAAA;AAArD,QAA6DP,OAAnE;AACA,WAAO,IAAIb,IAAJ,CAASc,EAAT,EAAaC,QAAb,EAAuBC,QAAvB,EAAiCC,SAAjC,EAA4CC,QAA5C,EAAqDC,KAArD,EAA4DC,IAA5D,CAAP;AACD,GAHM,CAAP;AAID;AAED,OAAO,eAAeC,SAAf,GAAmD;AACxD,QAAMd,QAAQ,GAAG,MAAML,aAAa,CAACM,GAAd,CAAkB,UAAlB,CAAvB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,QAAQ,CAACI,IAArB,EAFwD,CAGxD;;AAEA,SAAOJ,QAAQ,CAACe,OAAT,CAAiBV,GAAjB,CACJW,IAAD,IAAY;AAAC,WAAO,IAAIvB,IAAJ,CAASuB,IAAI,CAACC,MAAd,EAAsBD,IAAI,CAACR,QAA3B,EAAqCQ,IAAI,CAACP,QAA1C,EAAoDO,IAAI,CAACN,SAAzD,EAAoEM,IAAI,CAACL,QAAzE,EAAmFK,IAAI,CAACJ,KAAxF,EAA+FI,IAAI,CAACH,IAApG,CAAP;AAAiH,GADzH,EAEP,CAFO,CAAP;AAGD;AAED,OAAO,eAAeK,KAAf,CAAqBC,EAArB,EAAiCC,EAAjC,EAA4D;AACjE,MAAI;AACF,UAAMpB,QAAQ,GAAG,MAAML,aAAa,CAAC0B,IAAd,CAAmB,QAAnB,EAA6B;AAACb,MAAAA,QAAQ,EAAEW,EAAX;AAAeV,MAAAA,QAAQ,EAAEW;AAAzB,KAA7B,CAAvB;AACA,UAAM;AAACb,MAAAA,EAAD;AAAKC,MAAAA,QAAL;AAAeC,MAAAA,QAAf;AAAwBC,MAAAA,SAAxB;AAAkCC,MAAAA,QAAlC;AAA4CC,MAAAA,KAA5C;AAAmDC,MAAAA;AAAnD,QAA2Db,QAAQ,CAACI,IAA1E;AACA,WAAO,IAAIX,IAAJ,CAASc,EAAT,EAAaC,QAAb,EAAuBC,QAAvB,EAAiCC,SAAjC,EAA2CC,QAA3C,EAAqDC,KAArD,EAA4DC,IAA5D,CAAP;AACD,GAJD,CAIE,OAAOS,CAAP,EAAU;AACV,QAAGA,CAAC,CAACtB,QAAF,CAAWuB,MAAX,KAAsB,GAAtB,IAA4BD,CAAC,CAACtB,QAAF,CAAWuB,MAAX,KAAsB,GAArD,EAA0D;AACxD,YAAM,IAAI7B,gBAAJ,CAAqB,wBAArB,EAA+CyB,EAA/C,CAAN;AACD,KAFD,MAEO;AACL;AACA,YAAMG,CAAN;AACD;AACF;AAEF","sourcesContent":["import axios from 'axios';\nimport { User } from '../models/User';\nimport { FailedLoginError } from '../errors/FailedLoginError';\n\n\nconst libraryClient = axios.create({\n  baseURL: 'http://100.25.132.252:3000',\n  withCredentials: true,\n});\n\n//@adam : Library-express is running on my EC2 with public IP 18.232.125.207\n\n\nexport async function getAllUsers() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users');\n  // return response.data;\n  console.log(response.data);\n  return response.data.map((userObj: any) => {\n    const {id, username, password, firstname, lastname, email, role} = userObj;\n    return new User(id, username, password, firstname, lastname,email, role);\n  });\n}\n\nexport async function getSingle() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users/2');\n  console.log(response.data);\n  //return response.data;\n\n  return response.request.map(\n    (user:any)=>{return new User(user.userid, user.username, user.password, user.firstname, user.lastname, user.email, user.role)}\n)[0];\n}\n\nexport async function login(un: string, pw: string): Promise<User> {\n  try {\n    const response = await libraryClient.post('/login', {username: un, password: pw});\n    const {id, username, password,firstname,lastname, email, role} = response.data;\n    return new User(id, username, password, firstname,lastname, email, role);\n  } catch (e) {\n    if(e.response.status === 401 ||e.response.status === 400) {\n      throw new FailedLoginError('Failed to authenticate', un);\n    } else {\n      // We could throw a different custom error, this exposes a little too much to the user.\n      throw e;\n    }\n  }\n  \n}\n"]},"metadata":{},"sourceType":"module"}