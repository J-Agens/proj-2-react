{"ast":null,"code":"import axios from 'axios';\nimport { Book } from '../models/Book';\nimport { User } from '../models/User';\nimport { FailedLoginError } from '../errors/FailedLoginError'; // For project work, take note that axios interprets non-200s responses statuses as errors.\n// This means you can handle auth problems using try-catch.\n//We can create a client with config for convenience, then call our methods\n// on that client instead of on axios directly.  This lets up set up configuration\n// without repeating ourselves\n\nconst libraryClient = axios.create({\n  baseURL: 'http://100.25.132.252:3000',\n  // If you don't have the following line, your login won't work!\n  withCredentials: true\n}); //Library-express is running on my EC2 with public IP 18.232.125.207\n\nexport async function getAllBooks() {\n  const response = await libraryClient.get('/books');\n  return response.data.map(bookObj => {\n    const {\n      id,\n      title,\n      author,\n      yearPublished,\n      wordCount\n    } = bookObj;\n    return new Book(id, title, author, yearPublished, wordCount);\n  });\n}\nexport async function getAllUsers() {\n  const response = await libraryClient.get('/users'); // return response.data;\n\n  console.log(response.data);\n  return response.data.map(userObj => {\n    const {\n      id,\n      username,\n      password,\n      firstname,\n      lastname,\n      email,\n      role\n    } = userObj;\n    return new User(id, username, password, firstname, lastname, email, role);\n  });\n}\nexport async function getSingle() {\n  const response = await libraryClient.get('/users/2');\n  console.log(response.data); //return response.data;\n\n  return response.data.map(single => {\n    const {\n      id,\n      username,\n      password,\n      firstname,\n      lastname,\n      email,\n      role\n    } = single;\n    return new User(id, username, password, firstname, lastname, email, role);\n  });\n}\nexport async function login(un, pw) {\n  try {\n    const response = await libraryClient.post('/login', {\n      username: un,\n      password: pw\n    });\n    const {\n      id,\n      username,\n      password,\n      firstname,\n      lastname,\n      email,\n      role\n    } = response.data;\n    return new User(id, username, password, firstname, lastname, email, role);\n  } catch (e) {\n    if (e.response.status === 401 || e.response.status === 400) {\n      throw new FailedLoginError('Failed to authenticate', un);\n    } else {\n      // We could throw a different custom error, this exposes a little too much to the user.\n      throw e;\n    }\n  }\n}","map":{"version":3,"sources":["/Users/Shadow/react1/myapp/src/api/LibraryClient.tsx"],"names":["axios","Book","User","FailedLoginError","libraryClient","create","baseURL","withCredentials","getAllBooks","response","get","data","map","bookObj","id","title","author","yearPublished","wordCount","getAllUsers","console","log","userObj","username","password","firstname","lastname","email","role","getSingle","single","login","un","pw","post","e","status"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport { Book } from '../models/Book';\nimport { User } from '../models/User';\nimport { FailedLoginError } from '../errors/FailedLoginError';\n\n// For project work, take note that axios interprets non-200s responses statuses as errors.\n// This means you can handle auth problems using try-catch.\n\n//We can create a client with config for convenience, then call our methods\n// on that client instead of on axios directly.  This lets up set up configuration\n// without repeating ourselves\nconst libraryClient = axios.create({\n  baseURL: 'http://100.25.132.252:3000',\n  // If you don't have the following line, your login won't work!\n  withCredentials: true,\n});\n\n//Library-express is running on my EC2 with public IP 18.232.125.207\nexport async function getAllBooks() : Promise<Book[]> {\n  const response = await libraryClient.get('/books');\n  return response.data.map((bookObj: any) => {\n    const {id, title, author, yearPublished, wordCount} = bookObj;\n    return new Book(id, title, author, yearPublished, wordCount);\n  })\n}\n\nexport async function getAllUsers() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users');\n  // return response.data;\n  console.log(response.data);\n  return response.data.map((userObj: any) => {\n    const {id, username, password, firstname, lastname, email, role} = userObj;\n    return new User(id, username, password, firstname, lastname,email, role);\n  });\n}\nexport async function getSingle() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users/2');\n  console.log(response.data);\n  //return response.data;\n\n  return response.data.map((single: User) => {\n    const {id, username, password, firstname, lastname, email, role} = single;\n    return new User(id, username, password, firstname, lastname,email, role);\n  });\n}\n\nexport async function login(un: string, pw: string): Promise<User> {\n  try {\n    const response = await libraryClient.post('/login', {username: un, password: pw});\n    const {id, username, password,firstname,lastname, email, role} = response.data;\n    return new User(id, username, password, firstname,lastname, email, role);\n  } catch (e) {\n    if(e.response.status === 401 ||e.response.status === 400) {\n      throw new FailedLoginError('Failed to authenticate', un);\n    } else {\n      // We could throw a different custom error, this exposes a little too much to the user.\n      throw e;\n    }\n  }\n  \n}\n"]},"metadata":{},"sourceType":"module"}