{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Shadow/react1/myapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/Shadow/react1/myapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{Book}from'../models/Book';import{User}from'../models/User';import{FailedLoginError}from'../errors/FailedLoginError';// For project work, take note that axios interprets non-200s responses statuses as errors.\n// This means you can handle auth problems using try-catch.\n//We can create a client with config for convenience, then call our methods\n// on that client instead of on axios directly.  This lets up set up configuration\n// without repeating ourselves\nvar libraryClient=axios.create({baseURL:'http://100.25.132.252:3000/',// If you don't have the following line, your login won't work!\nwithCredentials:true});//Library-express is running on my EC2 with public IP 18.232.125.207\nexport function getAllBooks(){return _getAllBooks.apply(this,arguments);}function _getAllBooks(){_getAllBooks=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return libraryClient.get('/books');case 2:response=_context.sent;return _context.abrupt(\"return\",response.data.map(function(bookObj){var id=bookObj.id,title=bookObj.title,author=bookObj.author,yearPublished=bookObj.yearPublished,wordCount=bookObj.wordCount;return new Book(id,title,author,yearPublished,wordCount);}));case 4:case\"end\":return _context.stop();}}},_callee);}));return _getAllBooks.apply(this,arguments);}export function getAllUsers(){return _getAllUsers.apply(this,arguments);}function _getAllUsers(){_getAllUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return libraryClient.get('/users');case 2:response=_context2.sent;// return response.data;\nconsole.log(response.data);return _context2.abrupt(\"return\",response.data.map(function(userObj){var id=userObj.id,username=userObj.username,password=userObj.password,firstname=userObj.firstname,lastname=userObj.lastname,email=userObj.email,role=userObj.role;return new User(id,username,password,firstname,lastname,email,role);}));case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _getAllUsers.apply(this,arguments);}export function getSingle(){return _getSingle.apply(this,arguments);}function _getSingle(){_getSingle=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return libraryClient.get('/users/2');case 2:response=_context3.sent;console.log(response.data);//return response.data;\nreturn _context3.abrupt(\"return\",response.data.map(function(single){var id=single.id,username=single.username,password=single.password,firstname=single.firstname,lastname=single.lastname,email=single.email,role=single.role;return new User(id,username,password,firstname,lastname,email,role);}));case 5:case\"end\":return _context3.stop();}}},_callee3);}));return _getSingle.apply(this,arguments);}export function login(_x,_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(un,pw){var response,_response$data,id,username,password,firstname,lastname,email,role;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return libraryClient.post('/login',{username:un,password:pw});case 3:response=_context4.sent;_response$data=response.data,id=_response$data.id,username=_response$data.username,password=_response$data.password,firstname=_response$data.firstname,lastname=_response$data.lastname,email=_response$data.email,role=_response$data.role;return _context4.abrupt(\"return\",new User(id,username,password,firstname,lastname,email,role));case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);if(!(_context4.t0.response.status===401||_context4.t0.response.status===400)){_context4.next=14;break;}throw new FailedLoginError('Failed to authenticate',un);case 14:throw _context4.t0;case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return _login.apply(this,arguments);}","map":{"version":3,"sources":["/Users/Shadow/react1/myapp/src/api/LibraryClient.tsx"],"names":["axios","Book","User","FailedLoginError","libraryClient","create","baseURL","withCredentials","getAllBooks","get","response","data","map","bookObj","id","title","author","yearPublished","wordCount","getAllUsers","console","log","userObj","username","password","firstname","lastname","email","role","getSingle","single","login","un","pw","post","status"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport { Book } from '../models/Book';\nimport { User } from '../models/User';\nimport { FailedLoginError } from '../errors/FailedLoginError';\n\n// For project work, take note that axios interprets non-200s responses statuses as errors.\n// This means you can handle auth problems using try-catch.\n\n//We can create a client with config for convenience, then call our methods\n// on that client instead of on axios directly.  This lets up set up configuration\n// without repeating ourselves\nconst libraryClient = axios.create({\n  baseURL: 'http://100.25.132.252:3000/',\n  // If you don't have the following line, your login won't work!\n  withCredentials: true,\n});\n\n//Library-express is running on my EC2 with public IP 18.232.125.207\nexport async function getAllBooks() : Promise<Book[]> {\n  const response = await libraryClient.get('/books');\n  return response.data.map((bookObj: any) => {\n    const {id, title, author, yearPublished, wordCount} = bookObj;\n    return new Book(id, title, author, yearPublished, wordCount);\n  })\n}\n\nexport async function getAllUsers() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users');\n  // return response.data;\n  console.log(response.data);\n  return response.data.map((userObj: any) => {\n    const {id, username, password, firstname, lastname, email, role} = userObj;\n    return new User(id, username, password, firstname, lastname,email, role);\n  });\n}\nexport async function getSingle() : Promise<User[] | any> {\n  const response = await libraryClient.get('/users/2');\n  console.log(response.data);\n  //return response.data;\n\n  return response.data.map((single: User) => {\n    const {id, username, password, firstname, lastname, email, role} = single;\n    return new User(id, username, password, firstname, lastname,email, role);\n  });\n}\n\nexport async function login(un: string, pw: string): Promise<User> {\n  try {\n    const response = await libraryClient.post('/login', {username: un, password: pw});\n    const {id, username, password,firstname,lastname, email, role} = response.data;\n    return new User(id, username, password, firstname,lastname, email, role);\n  } catch (e) {\n    if(e.response.status === 401 ||e.response.status === 400) {\n      throw new FailedLoginError('Failed to authenticate', un);\n    } else {\n      // We could throw a different custom error, this exposes a little too much to the user.\n      throw e;\n    }\n  }\n  \n}\n"]},"metadata":{},"sourceType":"module"}